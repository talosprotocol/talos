#!/usr/bin/env bash
set -e

echo "üîç Running pre-commit checks for talos-sdk-py..."

echo "1) Running pytest..."
# Assume environment is set up. If not, user should set it up.
# We avoid pip install to be fast, but warn if missing.
if command -v pytest >/dev/null 2>&1; then
    pytest
else
    echo "‚ö†Ô∏è  pytest not found. Attempting python -m pytest..."
    python3 -m pytest
fi

echo "2) Scanning for hardcoded secrets..."
if [[ -f "../../scripts/scan-secrets.sh" ]]; then
    bash ../../scripts/scan-secrets.sh .
else
    echo "   ‚ö†Ô∏è  Shared secret scanner not found (skipped)"
fi

echo "‚úÖ talos-sdk-py checks passed!"
